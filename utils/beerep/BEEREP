   BEEREP - генератор отчетов (в т.ч. веб-форм) по транзакциям bee

   Для usage укажите какой-нибудь несуществующий ключ (например -?)

   Программа beerep создает HTML-страницу целиком или ее часть (ключ -h),
содержащую одну или несколько таблиц с отчетом по одному, нескольким или всем
аккаунтам bee, используя как источник данных файл лога транзакций 
(/var/bee/beelog.dat).

   Результирующий HTML-код программа выводит на stdout, перенаправьте вывод в
файл для получения HTML-отчета или выведите как часть страницы.

   Номер(-а) счета(-ов) либо задаются ключами -a (таких ключей может быть
несколько), ключом -A (все аккаунты), или, если таких ключей нет, список
аккаунтов читается с stdin.

   beerep -a 1:Maria -a 2:Peter > report.html (счета 1 и 2)
   beerep -A > report.html                    (все счета)
   cat users.list | beerep > report.html      (счета из списка "users.list")

  В ключе -a или строке списка, указывается номер счета и необязательный
комментарий.

  Информация по каждому аккаунту выводится отдельной таблицей (или отдельной
строкой таблицы если указан ключ -L). Перед таблицей выводится строка с номером
счета и комментарием в скобках. При указании ключа -s, после всех таблиц
(или последней строкой таблицы для режима -L) выводятся суммарные значения
трафика и денег.

  По умолчанию, отчет выводится по ресурсу inet (трафик интернета, ид 0),
ключом -r можно указать ид другого ресурса. Единственный другой ресурс, который
имеет смысл указывать это adder (начисления, ид 2). Чтобы сделать отчет по всем
ресурсам в куче, надо указать ключ -R.

  По умолчанию, отчет выводится за срок от начала лога по текущее время,
переопределить сроки можно ключами -F и/или -T.

  NB: если вы не указываете время, то по умолчанию время считается 00:00 (т.е. 
полночь). И если вы написали -T 12.05.2006, это фактически означает - 
ДО 11.05.2006 ВКЛЮЧИТЕЛЬНО.

  Альтернативный вариант ограничения установки периода для отчета -
использование ключей -F и -n (начало периода и количество дней). Ключ -n
требует наличия ключа -F и отсутствия ключа -T.

  По умолчанию, выводятся как записи по входящему, так и по исходящему трафику,
каждое из этих направлений можно подавить ключами -i и -o соответственно.

  По умолчанию, отчет подробно повторяет записи лога транзакций, при наличии
ключа -g данные группируются за весь период по направлению трафика, и
выводится только две строки. Ключи -L и -z принудительно включают группировку.

  Ключ -d заставляет программу использовать при адресации лога файл индекса
(/var/bee/beelog.idx). Значительно увеличивает работу программы (и уменьшает
бесполезную нагрузку на винт). Индекс необходимо пересоздавать утилитой logidx
(каждые сутки после часа ночи).

  Для скорости, ключом -d можно индексный файл (/var/)

  Типы выводимых колонок и их порядок по умолчанию определяются согласно
других параметров (-r, -g). Некоторые из возможных колонок по умолчанию
не выводятся никогда. Колонки и их порядок можно определить ключом -t. В нем
указываются буквы соответствующие типу колонки, в том порядке, в котором вам
нужно. Возможные типы колонок:

 D - дата транзакции
 T - время транзакции
 A - номер счета (по умолчанию не выводится никогда)
 B - состояние счета перед транзакцией (по умолчанию не выводится никогда)
 R - ид ресурса (по умолчанию не выводится никогда)
 C - counter (не выводмится для -r2)
 S - сумма транзакции
 P - средняя цена (по умолчанию не выводится никогда)
 E - код результата (по умолчанию не выводится никогда)
 I - направление трафика (не выводмится для -r2)
 H - клиентский адрес (не выводится для -r2 и -g)
   
   По умолчанию генерируется страница типа:

h     <html>
h     <head>
hE    <meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
hE    <meta http-equiv="Content-Language" content="ru">
hE    <title>Отчет билинга</title>
hc    <style>
hc    .txt
hc	{
hc	font-size: 9pt;
hc	font-family: "Arial";
hc	}
h     </style>
h     </head>
h     <body bgcolor=white>
hB    <font face="Arial, Helvetica, sans-serif" size="-1">
hB    <center>
h     <h3>
h     Отчет за период<br>
h     c  xx:xx:xxxx xx:xx:xx<br>
h     по xx:xx:xxxx xx:xx:xx<br>
h     </h3>
      Cчет # 0 (xxxxxxxxxx)
      <table border=0 bgcolor=black cellspacing=1 cellpadding=4 class="txt">
      <tr align=center bgcolor=#888888>
      <td><strong>название колонки</strong></td>
      ... ячейки с названием других колонок
      </tr>
      <tr bgcolor=#eeeeee>
      <td> значение </td>
      ... ячейки со значениями
      </tr>
      ... другие строки со значениями
      </table>
hB    </center>
hB    </font>
h     </body>
h     </html>

  Ключи для изменения шаблона:

-h          ключ подавляет вывод обрамления страницы и периода (строки, помеченные
            буквой "h" выше)

-c строка   переопределяет опции в теге <table> (опции по умолчанию не
            выводятся), также подавляет вывод дефолтных стилей (строки
            помеченные буквой "c" выше)

-C строка   переопределяет опции в теге <tr> для ячеек таблицы (опции по
            умолчанию не выводятся)

-H строка   переопределяет опции в теге <tr> для ячеек первой строки таблицы
            (опции по умолчанию не выводятся). Если ключ не указан, то для
            данных ячеек используются опции определенные ключом -С (или опции
            по умолчанию, если ни ключа -C, ни ключа -H не указано)

-b строка   переопределяет опции в теге <body> (опции по умолчанию не
            выводятся)

-E файл     определяет файл, содержащий строки заголовка (<head></head>)
            в место строк помеченных буквой "E" выше

-B файл     определяет файл шаблона тела HTML (<body></body>) вместо строк
            помеченных буквой "B" выше. Метка %BODY% (если она присутствует)
            показывает место где расположен сам отчет. Например, вывод по
            умолчанию соответствует шаблону:

               <font face="Arial, Helvetica, sans-serif" size="-1">
               <center>
               %BODY%
               </center>
               </font>
            
   Другие опции (не рассмотренные выше):

-I файл     Старый тип индексного файла (создать если не существует,
            использовать индексы начала и конца периода, если они
            соответствуют требуемому периоду, если необходимо - вычислить
            новые индексы и сохранить)

-L          Режим вывода нескольких аккаунтов в одну таблицу. Принудительно
            включает режим -g.

-z          Пропускать аккаунты с нулевой статистикой Принудительно включает
            режимы -L и -g

-m          При выводе в кило/мегабайтах не выводить байты

